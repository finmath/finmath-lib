<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/markdown/concepts/separationofproductandmodel/modelandproductdescriptors.md at 2022-09-29
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>finmath lib &#x2013; Separation of Product and Model and Numerical Method</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />
    <script src="../../js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarEnabled">
    <header id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
        <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
            <ul class="nav">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">finmath lib <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../../index.html" title="Introduction">Introduction</a></li>
            <li><a href="../../apidocs" title="API Documentation">API Documentation</a></li>
            <li><a href="../../gettingstarted.html" title="Getting Started">Getting Started</a></li>
            <li class="dropdown-submenu">
<a href="../../building.html" title="Building from Source">Building from Source</a>
              <ul class="dropdown-menu">
                  <li><a href="../../maven.html" title="Maven Build">Maven Build</a></li>
                  <li><a href="../../eclipseproject.html" title="Eclipse Project">Eclipse Project</a></li>
              </ul>
            </li>
            <li><a href="https://github.com/finmath/finmath-lib/releases" title="Releases">Releases</a></li>
            <li><a href="../../releasenotes.html" title="Release Notes">Release Notes</a></li>
            <li><a href="../../codingconventions.html" title="Coding Conventions">Coding Conventions</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Concepts <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../../concepts/stochasticautomaticdifferentiation" title="Stochastic Automatic Differentiation">Stochastic Automatic Differentiation</a></li>
            <li><a href="../../concepts/automatictrackingofmeasurability" title="Automatic Tracking of Measurability">Automatic Tracking of Measurability</a></li>
            <li class="dropdown-submenu">
<a href="../../concepts/separationofproductandmodel" title="Separation of Product and Model and Numerical Method">Separation of Product and Model and Numerical Method</a>
              <ul class="dropdown-menu">
                  <li><a href="../../concepts/separationofproductandmodel/modelandproductinterfaces.html" title="Model and Product Interfaces">Model and Product Interfaces</a></li>
                  <li><a href="../../concepts/separationofproductandmodel/modelandproductdescriptors.html" title="Model and Product Descriptors">Model and Product Descriptors</a></li>
              </ul>
            </li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Usages <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../../../finmath-experiments" title="Experiments">Experiments</a></li>
            <li><a href="../../../finmath-spreadsheets/" title="Spreadsheets">Spreadsheets</a></li>
            <li><a href="../../../topics/" title="Special Topics">Special Topics</a></li>
            <li><a href="http://christian-fries.de/finmath/applets/" title="Applets">Applets</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li class="dropdown-submenu">
<a href="../../project-info.html" title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                  <li><a href="../../summary.html" title="Summary">Summary</a></li>
                  <li><a href="../../scm.html" title="Source Code Management">Source Code Management</a></li>
                  <li><a href="../../distribution-management.html" title="Distribution Management">Distribution Management</a></li>
                  <li><a href="../../dependency-info.html" title="Dependency Information">Dependency Information</a></li>
                  <li><a href="../../dependencies.html" title="Dependencies">Dependencies</a></li>
                  <li><a href="../../issue-management.html" title="Issue Management">Issue Management</a></li>
                  <li><a href="../../ci-management.html" title="CI Management">CI Management</a></li>
                  <li><a href="../../licenses.html" title="Licenses">Licenses</a></li>
                  <li><a href="../../team.html" title="Team">Team</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
<a href="../../project-reports.html" title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                  <li><a href="../../apidocs/index.html" title="Javadoc">Javadoc</a></li>
                  <li><a href="../../surefire-report.html" title="Surefire Report">Surefire Report</a></li>
                  <li><a href="../../checkstyle.html" title="Checkstyle">Checkstyle</a></li>
              </ul>
            </li>
        </ul>
      </li>
            </ul>
            <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Links <b class="caret"></b></a>
                <ul class="dropdown-menu">
    <li><a href="../../../" title="finmath.net">finmath.net</a></li>
                </ul>
              </li>
            </ul>
        </div>
      </div>
    </header>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="../.././" id="bannerLeft"><h2>finmath lib</h2>
</a></div>
          <div class="pull-right"><a href="../../.." id="bannerRight"><img src="../../../artwork/logo.png"  alt="finmath.net" width="60"/></a></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2022-09-29<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 6.0.4</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">finmath lib</li>
    <li><a href="../../index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="../../apidocs" title="API Documentation"><span class="none"></span>API Documentation</a></li>
    <li><a href="../../gettingstarted.html" title="Getting Started"><span class="none"></span>Getting Started</a></li>
    <li><a href="../../building.html" title="Building from Source"><span class="icon-chevron-right"></span>Building from Source</a></li>
    <li><a href="https://github.com/finmath/finmath-lib/releases" class="externalLink" title="Releases"><span class="none"></span>Releases</a></li>
    <li><a href="../../releasenotes.html" title="Release Notes"><span class="none"></span>Release Notes</a></li>
    <li><a href="../../codingconventions.html" title="Coding Conventions"><span class="none"></span>Coding Conventions</a></li>
   <li class="nav-header">Concepts</li>
    <li><a href="../../concepts/stochasticautomaticdifferentiation" title="Stochastic Automatic Differentiation"><span class="none"></span>Stochastic Automatic Differentiation</a></li>
    <li><a href="../../concepts/automatictrackingofmeasurability" title="Automatic Tracking of Measurability"><span class="none"></span>Automatic Tracking of Measurability</a></li>
    <li><a href="../../concepts/separationofproductandmodel" title="Separation of Product and Model and Numerical Method"><span class="icon-chevron-down"></span>Separation of Product and Model and Numerical Method</a>
     <ul class="nav nav-list">
      <li><a href="../../concepts/separationofproductandmodel/modelandproductinterfaces.html" title="Model and Product Interfaces"><span class="none"></span>Model and Product Interfaces</a></li>
      <li class="active"><a href="#"><span class="none"></span>Model and Product Descriptors</a></li>
     </ul></li>
   <li class="nav-header">Usages</li>
    <li><a href="../../../finmath-experiments" title="Experiments"><span class="none"></span>Experiments</a></li>
    <li><a href="../../../finmath-spreadsheets/" title="Spreadsheets"><span class="none"></span>Spreadsheets</a></li>
    <li><a href="../../../topics/" title="Special Topics"><span class="none"></span>Special Topics</a></li>
    <li><a href="http://christian-fries.de/finmath/applets/" class="externalLink" title="Applets"><span class="none"></span>Applets</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../../project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="www.finmath.net/finmath-lib" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script>asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
    <div id="twitter" style="border:none; margin-top: 10px">
    <a href="https://twitter.com/finmathnet" class="twitter-follow-button" data-show-count="false" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow finmathnet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>Separation of Product and Model and Numerical Method</h1>
<p>02.02.2017, updated 22.06.2018.</p>
<p>[Work in progress. Will appear in a future version (4.x)]</p><section>
<h2><a name="Introduction"></a>Introduction</h2>
<p>Models and Products possibly come with different implementations for the different interfaces. For example, a Heston model may be implemented in a Monte-Carlo simulation, a Fourier transform or a Finite Difference method and a European option may be implemented against the three different interfaces. To allow for a unified way of model and product construction the model and products are constructed by implementation specific factories consuming implementation independent descriptors: the model descriptor and the product descriptor. Since it is reasonable to have one descriptor per object these are provided via a parametrized interface. That is a model may (should) implement</p>
<p><code>DescribedDescribedModel&lt;T extends ModelDescriptor&gt;</code></p>
<p>and a product may (should) implement</p>
<p><code>DescribedDescribedProduct&lt;T extends ProductDescriptor&gt;</code></p>
<p>Note: In case of a Model allowing construction from several different descriptors a common base type of the descriptors has to be defined (this is required due to type erasure in the parametrized interface).</p><section>
<h3><a name="Descriptors"></a>Descriptors</h3>
<p>The core concept here is to provide data, products, models and implementations (mostly) independent of each other. For this the realm of model and products is decomposed into the following components:</p>
<p><i>product descriptors</i>: A product descriptor is a class representing a financial product. It is a model independent representation comparable to a POJO. There should be factories creating product descriptor out of FpML, XML or Key-Value representations and a product descriptor should be able to serialize itself into these formats.</p>
<p><i>model descriptors</i>: A model descriptor is a class representing a financial model. It is independent of a specific numerical method. An example is a model descriptor for the equity Heston model, without specifying if the model is implemented as a PDE, Monte-Carlo simulation or Fourier transform.</p>
<p><i>model implementations</i>: Implement a specific model (or model family) using a specific numerical method. An instance of a model implementation can be created by passing a model descriptor. Models can perform a calibration utilising the specific implementation. The calibrated model can be serialized back to a model descriptor.</p>
<p><i>product implementations</i>: A product implementation implements the valuation of a financial product assuming a specific numerical method implemented by a model. An instance of a product implementation can be created by passing a product descriptor.</p></section><section>
<h3><a name="Factories"></a>Factories</h3>
<p>To allow the construction of products for a given model implementation without knowing the actual model and product implementation, models provide a product factory. That is all model implementations provide a method</p>

<div>
<div>
<pre class="source">	DescribedProduct&lt;? extends ProductDescriptor&gt; getProductFromDesciptor(ProductDescriptor productDescriptor);
</pre></div></div>

<p>Product factories may be registered with a model (or the library in general) including some priority. This allows to add product factories for new descriptors and to <i>inject</i> alternative product implementations to be used for specific descriptors.</p></section></section><section>
<h2><a name="Core_Interfaces"></a>Core Interfaces</h2>
<p>The concept is mirrored via a few interfaces:</p>

<div>
<div>
<pre class="source">interface ProductDescriptor {
	// Marker Interface
}
</pre></div></div>

<div>
<div>
<pre class="source">interface ModelDescriptor {
	// Marker Interface
}
</pre></div></div>

<div>
<div>
<pre class="source">public interface DescribedProduct&lt;T extends ProductDescriptor&gt; {

	/**
	 * Return a product descriptor representing this product.
	 * 
	 * @return The product descriptor of this product.
	 */
	T getDescriptor();
}
</pre></div></div>

<div>
<div>
<pre class="source">public interface DescribedModel&lt;T extends ModelDescriptor&gt; {

	/**
	 * Return a model descriptor representing this model.
	 * 
	 * @return The model descriptor of this model.
	 */
	T getDescriptor();
	

	/**
	 * Construct a product from a product descriptor, which may be valued by this mmodel.
	 * 
	 * @param productDescriptor Given product descriptor.
	 * @return An instance of a product implementation.
	 */
	DescribedProduct&lt;? extends ProductDescriptor&gt; getProductFromDesciptor(ProductDescriptor productDescriptor);
}
</pre></div></div>
</section><section>
<h2><a name="Product_and_Model_Factories"></a>Product and Model Factories</h2>
<p>Product and models are constructed by implementing factories. Factories carry the implementation specific part of the model or product. For example: A Fourier transform implementation of a Heston model requires the specification of the integration method used (line of integration, number of integration points, etc.). A Monte-Carlo implementation of a Heston model requires the specification of the Brownian driver (random number generator) and numerical scheme (Euler scheme with truncation, etc.).</p>
<p>For this reason we have two additional interfaces</p>

<div>
<div>
<pre class="source">public interface ProductFactory&lt;T extends ProductDescriptor&gt; {

	/**
	 * Constructs the product from a given product descriptor.
	 * 
	 * @param descriptor A product descriptor.
	 * @return An instance of the product describable by this descriptor.
	 */
	DescribedProduct&lt;? extends T&gt; getProductFromDescription(T descriptor);
}
</pre></div></div>

<div>
<div>
<pre class="source">public interface ModelFactory&lt;T extends ModelDescriptor&gt; {

	DescribedModel&lt;? extends T&gt; getModelFromDescriptor(T description);
}
</pre></div></div>
</section><section>
<h2><a name="Calibration_Round_Trip"></a>Calibration Round Trip</h2>
<p>The setup allows to perform calibrations using specific calibration products and numerical methods to be re-used in more general models. Consider for example an Equity Heston model implemented as Monte-Carlo simulation. While brute-force Monte-Carlo calibration is expensive, fast an accurate valuations (and hence calibrations) exists for a restricted set of products where fast Fourier transforms can be utilized. Hence, calibration of the Monte-Carlo Heston model can be performed in the following steps:</p>
<ul>

<li>Create a Fourier transform implementation of the Heston model.</li>
<li>Create ProductDescriptors for the calibration products.</li>
<li>The model will create Fourier transform representations for the calibration products.</li>
<li>Generically calibrate the Heston model using Fourier transforms.</li>
<li>Extract the model descriptor from the calibrated model.</li>
<li>Create the Monte-Carlo Heston model from the model descriptor of the calibrated model.</li>
<li>The Monte-Carlo model will create Monte-Carlo implementations of the calibration products using the Monte-Carlo Heston model&#x2019;s product factory.</li>
<li>Check that the Monte-Carlo Heston model is calibrated by checking the calibration products.</li>
</ul></section><section>
<h2><a name="Specifications_specific_to_the_Numerical_Method"></a>Specifications specific to the Numerical Method</h2>
<p>The implementation of a model may require additional specifications. These additional specifications are <i>not</i> part of the model descriptor. They belong to the model factory.</p><section>
<h3><a name="Example"></a>Example</h3>
<p>A standard Black Scholes model with constant coefficients is fully determined by the initial value, the drift and the volatility. A Monte-Carlo simulation of this model requires a time-discretization of the Euler-Scheme, the number of paths, specifications related to the random number generators, etc., which are part of the BlackScholesModelMonteCarloFactory. A Fourier transform implementation of this model requires specification of the integration method applied to the characteristic functions, which are part of the BlackScholesModelFourierFactory.</p></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2022
<a href="http://finmath.net">finmath.net</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>